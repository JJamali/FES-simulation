function [force_length_regression] = get_muscle_force_length_regression()

data = [41.81818182 2.202365536
37.44107744	9.838556505
38.45117845	14.72330139
40.47138047	17.82612449
40.4040404	21.92782526
39.32659933	24.73452473
43.90572391	22.48553915
43.43434343	24.01795735
42.92929293	24.01148234
41.48148148	27.06984374
41.48148148	16.17240784
41.44781145	14.76171976
39.46127946	3.838815505
41.44781145	31.81300181
42.12121212	32.20625054
40.43771044	36.92825693
43.46801347	35.3004403
43.46801347	34.91582492
42.55892256	42.34006734
43.46801347	44.78761979
42.8956229	46.44694811
45.58922559	43.78917379
44.44444444	45.69757403
45.58922559	46.73789174
45.58922559	46.48148148
46.73400673	44.95769662
42.86195286	48.4977985
43.16498316	50.42476042
43.46801347	54.27479927
45.45454545	53.65924199
45.25252525	54.1694725
43.77104377	57.35560736
44.44444444	60.69757403
46.43097643	62.77432444
47.44107744	62.78727445
49.02356902	63.19217819
47.71043771	66.89329189
45.75757576	67.89389623
45.95959596	70.84520418
46.46464646	71.62090995
47.40740741	71.76120176
50.60606061	74.62272296
49.46127946	76.27471294
46.43097643	73.79996547
46.7003367	75.5982906
50.80808081	78.08685142
50.97643098	80.26849694
51.17845118	78.60442027
50.80808081	78.4714668
53.53535354	78.89104722
53.56902357	83.50686351
49.7979798	81.92005525
48.98989899	82.29431063
48.98989899	81.90969524
48.98989899	81.2686696
47.13804714	80.60390227
47.60942761	81.76379176
47.47474747	81.7620651
48.18181818	83.43779677
48.92255892	85.4985755
49.83164983	85.12561513
49.66329966	86.66191833
50.67340067	85.26461193
50.67340067	85.00820167
50.70707071	87.31632565
50.26936027	87.69532936
50.70707071	90.64965898
51.51515152	89.7625831
51.71717172	91.17542951
52.65993266	89.39264439
53.2996633	88.75982043
53.93939394	92.22956056
53.63636364	92.61029094
54.30976431	94.67020634
54.17508418	94.02745403
53.5016835	94.91625658
53.56902357	96.58378658
53.8047138	96.84321851
54.68013468	99.8031598
55.72390572	96.22679789
56.12794613	96.2319779
57.81144781	91.38176638
58.41750842	91.004921
59.36026936	91.40162307
56.43097643	99.82560649
57.27272727	98.04152637
57.50841751	99.83941984
57.84511785	99.58732625
56.8013468	99.83035483
57.07070707	99.70560304
57.07070707	99.0645774
58.55218855	96.39126306
58.88888889	99.34429768
59.36026936	98.06828973
60.53872054	99.87826988
59.66329966	95.89268756
59.86531987	96.92091859
59.96632997	95.89657256
60.57239057	93.85306052
61.34680135	95.14504015
62.32323232	96.69602003
61.34680135	92.1963222
62.18855219	89.77121644
61.41414141	88.09462143
61.27946128	84.75956143
63.13131313	86.57817491
63.7037037	90.04705171
64.51178451	87.2368989
63.77104377	87.22740223
63.63636364	85.94362428
63.63636364	85.55900889
61.41414141	79.88949322
61.41414141	77.19718553
62.59259259	80.0328067
63.93939394	76.58853492
64.51178451	82.2368989
63.46801347	79.91582492
63.83838384	80.56159889
63.4006734	81.06880774
65.11784512	76.60364327
66.3973064	75.97902098
65.55555556	73.27592161
66.12794613	72.64223431
65.69023569	68.66226366
65.75757576	66.74005007
65.35353535	64.55538289
66.86868687	66.62608996
67.17171717	63.68125701
67.77777778	63.04800138
68.41750842	60.10748511
63.36700337	59.78632479
63.36700337	53.37606838
64.78114478	53.90701891
64.78114478	52.36855737
67.50841751	52.27531728
76.3973064	9.312354312
75.38720539	13.27376327
74.41077441	13.51765518
73.4006734	13.37650004
75.21885522	18.52801519
73.43434343	19.27436761
73.43434343	18.50513684
72.96296296	26.31960632
72.39057239	25.28662695
73.4006734	35.17137184
71.41414141	35.14590348
70.23569024	30.13079513
70.4040404	30.13295347
68.55218855	27.80151947
67.40740741	36.12017612
67.03703704	43.16670983
69.39393939	42.1712855
70.57239057	49.10947078
65.72390572	48.40628507];

data = sortrows(data);

% Input Parameters
% data(:,1): samples of an independent variable (muscle length)
% data(:,2): corresponding samples of a dependent variable (tension)

% Output
% force_length_regression: the genered Gaussian model

% Define data points by importing data and saving them to arrays
muscle_length = data(:, 1);
muscle_force = data(:, 2);

% Normalization
% normalize tension values between 0-1 and optimal length should be 1 
[max_force, idx_max_force] = max(muscle_force);
normalized_force = muscle_force./max_force;
normalized_length = muscle_length./muscle_length(idx_max_force); 

norm_data = [normalized_length, normalized_force];

% Regression with "fit" function with "gauss2" option as model type
force_length_regression = fit(norm_data(:,1), norm_data(:,2), 'gauss2');

figure(4);
subplot(1,2,1);
plot(norm_data(:,1),norm_data(:,2));
title("Unfitted force-length");
subplot(1,2,2);
plot(norm_data(:,1),feval(force_length_regression,norm_data(:,1)));
title("Fitted force-length");
end
